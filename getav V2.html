<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BushSEC - 安全软件检测工具</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #00cc00;
            --primary-hover: #00ff00;
            --primary-light: rgba(0, 204, 0, 0.1);
            --primary-dark: #009900;
            --bg-dark: #0f1419;
            --bg-light: #1a1f25;
            --bg-card: #141a21;
            --text-color: #f0f0f0;
            --text-muted: #a0a0a0;
            --border-color: #2a3038;
            --card-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            --glow: 0 0 15px rgba(0, 204, 0, 0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', Arial, sans-serif;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-color);
            line-height: 1.6;
            background-image: 
                radial-gradient(circle at 25% 10%, rgba(0, 204, 0, 0.05) 0%, transparent 20%),
                radial-gradient(circle at 75% 75%, rgba(0, 204, 0, 0.05) 0%, transparent 20%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
        }

        header h1 {
            color: var(--primary-color);
            font-size: 3.5em;
            margin-bottom: 10px;
            text-shadow: var(--glow);
            letter-spacing: 2px;
            font-weight: 700;
            position: relative;
            display: inline-block;
        }

        header h1::after {
            content: "";
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--primary-color), transparent);
        }

        header p {
            color: var(--text-muted);
            font-size: 1.2em;
            margin-top: 15px;
        }

        .search-section {
            background-color: var(--bg-light);
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 40px;
            border: 1px solid var(--border-color);
            box-shadow: var(--card-shadow);
            position: relative;
            overflow: hidden;
        }

        .search-section::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--primary-color), transparent);
        }

        .search-box {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }

        .search-input {
            flex: 1;
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--bg-dark);
            color: var(--text-color);
            font-size: 16px;
            resize: vertical;
            transition: all 0.3s ease;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px var(--primary-light);
        }

        .analyze-btn {
            padding: 15px 30px;
            background-color: var(--primary-color);
            color: #000;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .analyze-btn:hover {
            background-color: var(--primary-hover);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .analyze-btn:active {
            transform: translateY(0);
            background-color: var(--primary-dark);
        }

        .results-section {
            background-color: var(--bg-light);
            padding: 30px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            box-shadow: var(--card-shadow);
            position: relative;
            overflow: hidden;
        }

        .results-section::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--primary-color), transparent);
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .results-header h2 {
            font-size: 1.8em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .results-count {
            color: var(--primary-color);
            font-weight: bold;
            font-size: 1.1em;
            background-color: var(--primary-light);
            padding: 8px 15px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
        }

        .av-card {
            background-color: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .av-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background-color: var(--primary-color);
            opacity: 0.7;
        }

        .av-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary-color);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
        }

        .av-name {
            color: var(--primary-color);
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 1.2em;
            padding-bottom: 10px;
            border-bottom: 1px dashed var(--border-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .av-name::before {
            content: "\f132";
            font-family: "Font Awesome 6 Free";
            font-weight: 900;
        }

        .process-list {
            list-style: none;
            margin-left: 5px;
        }

        .process-item {
            padding: 8px 0;
            font-size: 0.9em;
            color: var(--text-muted);
            border-bottom: 1px dotted rgba(255, 255, 255, 0.1);
            word-break: break-all;
        }

        .process-item:last-child {
            border-bottom: none;
        }

        .loading {
            text-align: center;
            padding: 30px;
            display: none;
            font-size: 1.2em;
        }

        .loading-spinner {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 3px solid rgba(0, 204, 0, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 15px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .empty-result {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-muted);
            font-size: 1.1em;
        }

        .empty-result i {
            font-size: 3em;
            margin-bottom: 15px;
            color: var(--primary-color);
            opacity: 0.5;
        }

        footer {
            text-align: center;
            margin-top: 60px;
            padding: 20px;
            color: var(--text-muted);
            font-size: 0.9em;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
        }

        .footer-links a {
            color: var(--text-muted);
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-links a:hover {
            color: var(--primary-color);
        }

        /* 响应式设计 */
        @media (max-width: 768px) {
            header h1 {
                font-size: 2.5em;
            }
            
            .search-section, .results-section {
                padding: 20px;
            }
            
            .results-grid {
                grid-template-columns: 1fr;
            }
            
            .results-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>BushSEC</h1>
            <p>在线安全软件识别</p>
        </header>

        <section class="search-section">
            <div class="search-box">
                <textarea class="search-input" placeholder="请粘贴 tasklist /svc 命令的输出结果..." rows="10"></textarea>
            </div>
            <button class="analyze-btn" onclick="analyzeOutput()">
                <i class="fas fa-search"></i> 开始分析
            </button>
        </section>

        <section class="results-section">
            <div class="results-header">
                <h2><i class="fas fa-shield-alt"></i> 检测结果</h2>
                <span class="results-count">
                    <i class="fas fa-chart-pie"></i>
                    发现 <span id="count">0</span> 个安全软件
                </span>
            </div>
            <div class="loading" id="loading">
                <div class="loading-spinner"></div>
                <p>正在分析中，请稍候...</p>
            </div>
            <div class="results-grid" id="results"></div>
        </section>

        <footer>
            <p>© 2025 BushSEC. All rights reserved.</p>
            </div>
        </footer>
    </div>

    <script>
        // 安全软件特征库 (保持原有代码)
const avSignatures = {
    'ALYac': ['aylaunch.exe', 'ayupdate2.exe', 'AYRTSrv.exe', 'AYAgent.exe'],
    'AVG': ['AVGSvc.exe', 'AVGUI.exe', 'avgwdsvc.exe', 'avg.exe', 'avgaurd.exe', 'avgemc.exe', 'avgrsx.exe', 'avgserv.exe', 'avgw.exe'],
    'Acronis': ['arsm.exe', 'acronis_license_service.exe'],
    'Ad-Aware': ['AdAwareService.exe', 'Ad-Aware.exe', 'AdAware.exe'],
    'AhnLab-V3': ['patray.exe', 'V3Svc.exe'],
    'Arcabit': ['arcavir.exe', 'arcadc.exe', 'ArcaVirMaster.exe', 'ArcaMainSV.exe', 'ArcaTasksService.exe'],
    'Avast': ['ashDisp.exe', 'AvastUI.exe', 'AvastSvc.exe', 'AvastBrowser.exe', 'AfwServ.exe'],
    'Avira AntiVirus(小红伞)': ['avcenter.exe', 'avguard.exe', 'avgnt.exe', 'sched.exe'],
    'Baidu AntiVirus': ['BaiduSdSvc.exe', 'BaiduSdTray.exe', 'BaiduSd.exe', 'bddownloader.exe', 'baiduansvx.exe'],
    'BitDefender': ['Bdagent.exe', 'BitDefenderCom.exe', 'vsserv.exe', 'bdredline.exe', 'secenter.exe', 'bdservicehost.exe', 'BITDEFENDER.exe'],
    'Bkav': ['BKavService.exe', 'Bka.exe', 'BkavUtil.exe', 'BLuPro.exe'],
    'CAT-QuickHeal': ['QUHLPSVC.exe', 'onlinent.exe', 'sapissvc.exe', 'scanwscs.exe'],
    'CMC': ['CMCTrayIcon.exe'],
    'ClamAV': ['freshclam.exe'],
    'Comodo': ['cpf.exe', 'cavwp.exe', 'ccavsrv.exe', 'cmdvirth.exe'],
    'CrowdStrike Falcon(猎鹰)': ['csfalconservice.exe', 'CSFalconContainer.exe'],
    'Cybereason': ['CybereasonRansomFree.exe', 'CybereasonRansomFreeServiceHost.exe', 'CybereasonAV.exe'],
    'Cylance': ['CylanceSvc.exe'],
    'Cyren': ['vsedsps.exe', 'vseamps.exe', 'vseqrts.exe'],
    'DrWeb': ['drwebcom.exe', 'spidernt.exe', 'drwebscd.exe', 'drweb32w.exe', 'dwengine.exes'],
    'ESET-NOD32': ['egui.exe', 'ecls.exe', 'ekrn.exe', 'eguiProxy.exe', 'EShaSrv.exe'],
    'Trend Micro（趋势科技）': ['tmpfw.exe', 'tmlisten.exe', 'coreServiceShell.exe', 'coreFrameworkHost.exe', 'uiWatchDog.exe', 'TMLISTEN.exe'],
    'Emsisoft': ['a2guard.exe', 'a2free.exe', 'a2service.exe'],
    'Endgame': ['endgame.exe'],
    'F-Prot': ['F-PROT.exe', 'FProtTray.exe', 'FPAVServer.exe', 'f-stopw.exe', 'f-prot95.exe', 'f-agnt95.exe'],
    'F-Secure': ['f-secure.exe', 'fssm32.exe', 'Fsorsp64.exe', 'fsavgui.exe', 'fameh32.exe', 'fch32.exe', 'fih32.exe', 'fnrb32.exe', 'fsav32.exe', 'fsma32.exe', 'fsmb32.exe'],
    'FireEye(火眼)': ['xagtnotif.exe', 'xagt.exe'],
    'Fortinet（飞塔）': ['FortiClient.exe', 'FortiTray.exe', 'FortiScand.exe', 'FortiWF.exe', 'FortiProxy.exe', 'FortiESNAC.exe', 'FortiSSLVPNdaemon.exe', 'FortiTcs.exe', 'FctSecSvr.exe'],
    'GData': ['AVK.exe', 'avkcl.exe', 'avkpop.exe', 'avkservice.exe', 'GDScan.exe', 'AVKWCtl.exe', 'AVKProxy.exe', 'AVKBackupService.exe'],
    'Ikarus': ['guardxservice.exe', 'guardxkickoff.exe'],
    'Jiangmin': ['KVFW.exe', 'KVsrvXP.exe', 'KVMonXP.exe', 'KVwsc.exe'],
    'K7AntiVirus': ['K7TSecurity.exe', 'K7TSMain.Exe', 'K7TSUpdT.exe'],
    'Kaspersky(卡巴斯基)': ['avp.exe', 'avpcc.exe', 'avpm.exe', 'kavpf.exe', 'kavfs.exe', 'klnagent.exe', 'kavtray.exe', 'kavfswp.exe', 'kaspersky.exe'],
    'Max Secure Software': ['SDSystemTray.exe', 'MaxRCSystemTray.exe', 'RCSystemTray.exe', 'MaxAVPlusDM.exe', 'LiveUpdateSD.exe'],
    'Malwarebytes': ['MBAMService.exe', 'mbam.exe', 'mbamtray.exe'],
    'McAfee(迈克菲)': ['Mcshield.exe', 'Tbmon.exe', 'Frameworkservice.exe', 'firesvc.exe', 'firetray.exe', 'hipsvc.exe', 'mfevtps.exe', 'mcafeefire.exe', 'shstat.exe', 'vstskmgr.exe', 'engineserver.exe', 'alogserv.exe', 'avconsol.exe', 'cmgrdian.exe', 'cpd.exe', 'mcmnhdlr.exe', 'mcvsshld.exe', 'mcvsrte.exe', 'mghtml.exe', 'mpfservice.exe', 'mpfagent.exe', 'mpftray.exe', 'vshwin32.exe', 'vsstat.exe', 'guarddog.exe', 'mfeann.exe', 'udaterui.exe', 'naprdmgr.exe', 'mctray.exe', 'fcagate.exe', 'fcag.exe', 'fcags.exe', 'fcagswd.exe', 'macompatsvc.exe', 'masvc.exe', 'mcamnsvc.exe', 'mctary.exe', 'mfecanary.exe', 'mfeconsole.exe', 'mfeesp.exe', 'mfefire.exe', 'mfefw.exe', 'mfemms.exe', 'mfetp.exe', 'mfewc.exe', 'mfewch.exe'],
    'Microsoft Security Essentials': ['MsMpEng.exe', 'msseces.exe', 'mssecess.exe', 'emet_agent.exe', 'emet_service.exe', 'drwatson.exe', 'MpCmdRun.exe', 'NisSrv.exe', 'MsSense.exe', 'MSASCui.exe', 'MSASCuiL.exe', 'SecurityHealthService.exe'],
    'NANO-Antivirus': ['nanoav.exe', 'nanoav64.exe', 'nanoreport.exe', 'nanoreportc.exe', 'nanoreportc64.exe', 'nanorst.exe', 'nanosvc.exe'],
    'Palo Alto Networks': ['PanInstaller.exe'],
    'Panda Security': ['remupd.exe', 'apvxdwin.exe', 'pavproxy.exe', 'pavsched.exe'],
    'Qihoo-360': ['360sd.exe', '360tray.exe', 'ZhuDongFangYu.exe', '360rp.exe', '360rps.exe', '360safe.exe', '360safebox.exe', 'QHActiveDefense.exe', '360skylarsvc.exe', 'LiveUpdate360.exe'],
    'Rising': ['RavMonD.exe', 'rfwmain.exe', 'RsMgrSvc.exe', 'RavMon.exe'],
    'SUPERAntiSpyware': ['superantispyware.exe', 'sascore.exe', 'SAdBlock.exe', 'sabsvc.exe'],
    'SecureAge APEX': ['UniversalAVService.exe', 'EverythingServer.exe', 'clamd.exe'],
    'Sophos AV': ['SavProgress.exe', 'icmon.exe', 'SavMain.exe', 'SophosUI.exe', 'SophosFS.exe', 'SophosHealth.exe', 'SophosSafestore64.exe', 'SophosCleanM.exe', 'SophosFileScanner.exe', 'SophosNtpService.exe', 'SophosOsquery.exe', 'Sophos UI.exe'],
    'TACHYON': [],
    'Tencent': ['QQPCRTP.exe', 'QQPCTray.exe', 'QQPCMgr.exe', 'QQPCNetFlow.exe', 'QQPCRealTimeSpeedup.exe'],
    'TotalDefense': ['AMRT.exe', 'SWatcherSrv.exe', 'Prd.ManagementConsole.exe'],
    'Trapmine': ['TrapmineEnterpriseService.exe', 'TrapmineEnterpriseConfig.exe', 'TrapmineDeployer.exe', 'TrapmineUpgradeService.exe'],
    'TrendMicro': ['TMBMSRV.exe', 'ntrtscan.exe', 'Pop3Trap.exe', 'WebTrap.exe', 'PccNTMon.exe'],
    'VIPRE': ['SBAMSvc.exe', 'VipreEdgeProtection.exe', 'SBAMTray.exe'],
    'ViRobot': ['vrmonnt.exe', 'vrmonsvc.exe', 'Vrproxyd.exe'],
    'Webroot': ['npwebroot.exe', 'WRSA.exe', 'spysweeperui.exe'],
    'Yandex': ['Yandex.exe', 'YandexDisk.exe', 'yandesk.exe'],
    'Zillya': ['zillya.exe', 'ZAVAux.exe', 'ZAVCore.exe'],
    'ZoneAlarm': ['vsmon.exe', 'zapro.exe', 'zonealarm.exe'],
    'Zoner': ['ZPSTray.exe'],
    'eGambit': ['dasc.exe', 'memscan64.exe', 'dastray.exe'],
    'eScan': ['consctl.exe', 'mwaser.exe', 'avpmapp.exe'],
    'Lavasoft': ['AAWTray.exe', 'LavasoftTcpService.exe', 'AdAwareTray.exe', 'WebCompanion.exe', 'WebCompanionInstaller.exe', 'adawarebp.exe', 'ad-watch.exe'],
    'The Cleaner': ['cleaner8.exe'],
    'VBA32': ['vba32lder.exe'],
    'Mongoosa': ['MongoosaGUI.exe', 'mongoose.exe'],
    'Coranti2012': ['CorantiControlCenter32.exe'],
    'UnThreat': ['UnThreat.exe', 'utsvc.exe'],
    'Shield Antivirus': ['CKSoftShiedAntivirus4.exe', 'shieldtray.exe'],
    'VIRUSfighter': ['AVWatchService.exe', 'vfproTray.exe'],
    'Immunet': ['iptray.exe'],
    'PSafe': ['PSafeSysTray.exe', 'PSafeCategoryFinder.exe', 'psafesvc.exe'],
    'nProtect': ['nspupsvc.exe', 'Npkcmsvc.exe', 'npnj5Agent.exe'],
    'Spyware Terminator': ['SpywareTerminatorShield.exe', 'SpywareTerminator.exe'],
    'Norton（赛门铁克）': ['ccSvcHst.exe', 'rtvscan.exe', 'ccapp.exe', 'NPFMntor.exe', 'ccRegVfy.exe', 'vptray.exe', 'iamapp.exe', 'nav.exe', 'navapw32.exe', 'navapsvc.exe', 'nisum.exe', 'nmain.exe', 'nprotect.exe', 'smcGui.exe', 'ns.exe', 'nortonsecurity.exe'],
    'Symantec（赛门铁克）': ['ccSetMgr.exe', 'ccapp.exe', 'vptray.exe', 'ccpxysvc.exe', 'cfgwiz.exe', 'smc.exe', 'symproxysvc.exe', 'vpc32.exe', 'lsetup.exe', 'luall.exe', 'lucomserver.exe', 'sbserv.exe', 'ccEvtMgr.exe', 'smcGui.exe', 'snac.exe', 'SymCorpUI.exe', 'sepWscSvc64.exe'],
    '可牛杀毒': ['knsdtray.exe'],
    '流量矿石': ['Miner.exe'],
    'SafeDog(安全狗)': ['safedog.exe', 'SafeDogGuardCenter.exe', 'SafeDogSiteIIS.exe', 'SafeDogTray.exe', 'SafeDogServerUI.exe', 'SafeDogSiteApache.exe', 'CloudHelper.exe', 'SafeDogUpdateCenter.exe'],
    '木马克星': ['parmor.exe', 'Iparmor.exe'],
    '贝壳云安全': ['beikesan.exe'],
    '木马猎手': ['TrojanHunter.exe'],
    '巨盾网游安全盾': ['GG.exe'],
    '绿鹰安全精灵': ['adam.exe'],
    '超级巡警': ['AST.exe'],
    '墨者安全专家': ['ananwidget.exe'],
    '风云防火墙': ['FYFireWall.exe'],
    '微点主动防御': ['MPMon.exe'],
    '天网防火墙': ['pfw.exe'],
    'D 盾': ['D_Safe_Manage.exe', 'd_manage.exe'],
    '云锁': ['yunsuo_agent_service.exe', 'yunsuo_agent_daemon.exe'],
    '护卫神': ['HwsPanel.exe', 'hws_ui.exe', 'hws.exe', 'hwsd.exe', 'HwsHostPanel.exe', 'HwsHostMaster.exe'],
    '火绒安全': ['hipstray.exe', 'wsctrl.exe', 'usysdiag.exe', 'HipsDaemon.exe', 'HipsLog.exe', 'HipsMain.exe', 'wsctrlsvc.exe'],
    '网络病毒克星': ['WEBSCANX.exe'],
    'SPHINX防火墙': ['SPHINX.exe'],
    '奇安信天擎': ['TQClient.exe', 'TQTray.exe', 'QaxEngManager.exe', 'TQDefender.exe'],
    'H+BEDV Datentechnik GmbH': ['avwin.exe', 'avwupsrv.exe'],
    'IBM ISS Proventia': ['blackd.exe', 'rapapp.exe'],
    'eEye Digital Security': ['eeyeevnt.exe', 'blink.exe'],
    'Kerio Personal Firewall': ['persfw.exe', 'wrctrl.exe'],
    'Simplysup': ['Trjscan.exe'],
    'PC Tools AntiVirus': ['PCTAV.exe', 'pctsGui.exe'],
    'VirusBuster Professional': ['vbcmserv.exe'],
    'ClamWin': ['ClamTray.exe', 'clamscan.exe'],
    '安天智甲': ['kxetray.exe', 'kscan.exe', 'AMediumManager.exe', 'kismain.exe'],
    'CMC Endpoint Security': ['CMCNECore.exe', 'cmcepagent.exe', 'cmccore.exe', 'CMCLog.exe', 'CMCFMon.exe'],
    '金山毒霸': ['kxetray.exe', 'kxescore.exe', 'kupdata.exe', 'kwsprotect64.exe', 'kislive.exe', 'knewvip.exe', 'kscan.exe', 'kxecenter.exe', 'kxemain.exe', 'KWatch.exe', 'KSafeSvc.exe', 'KSafeTray.exe'],
    'Agnitum outpost (Outpost Firewall)': ['outpost.exe', 'acs.exe'],
    'Cynet': ['CynetLauncher.exe', 'CynetDS.exe', 'CynetEPS.exe', 'CynetMS.exe', 'CynetAR.exe', 'CynetGW.exe', 'CynetSD64.exe'],
    'Elastic': ['winlogbeat.exe'],
    '金山网盾': ['KSWebShield.exe'],
    'G Data安全软件客户端': ['AVK.exe'],
    '金山网镖': ['kpfwtray.exe'],
    '在扫1433': ['1433.exe'],
    '在爆破': ['DUB.exe'],
    '发现S-U': ['ServUDaemon.exe'],
    '百度卫士': ['bddownloader.exe', 'baiduSafeTray.exe'],
    '百度卫士-主进程': ['baiduansvx.exe'],
    'G Data文件系统实时监控': ['avkwctl9.exe', 'AVKWCTL.exe'],
    'Sophos Anti-Virus': ['SAVMAIN.exe'],
    '360保险箱': ['safeboxTray.exe', '360safebox.exe'],
    'G Data扫描器': ['GDScan.exe'],
    'G Data杀毒代理': ['AVKProxy.exe'],
    'G Data备份服务': ['AVKBackupService.exe'],
    '亚信安全服务器深度安全防护系统': ['Notifier.exe'],
    '阿里云盾': ['AliYunDun.exe', 'AliYunDunUpdate.exe', 'aliyun_assist_service.exe', '/usr/local/aegis/aegis_client/'],
    '腾讯云安全': ['BaradAgent.exe', 'sgagent.exe', 'YDService.exe', 'YDLive.exe', 'YDEdr.exe'],
    '360主机卫士Web': ['360WebSafe.exe', 'QHSrv.exe', 'QHWebshellGuard.exe'],
    '网防G01': ['gov_defence_service.exe', 'gov_defence_daemon.exe'],
    '云锁客户端': ['PC.exe'],
    'Symantec Shared诺顿邮件防火墙软件': ['SNDSrvc.exe'],
    'U盘杀毒专家': ['USBKiller.exe'],
    '天擎EDRAgent': ['360EntClient.exe'],
    '360(奇安信)天擎': ['360EntMisc.exe'],
    '阿里云-云盾': ['alisecguard.exe'],
    'Sophos AutoUpdate Service': ['ALsvc.exe'],
    '阿里云监控': ['CmsGoAgent.windows-amd64.'],
    '深信服EDRAgent': ['edr_agent.exe', 'edr_monitor.exe', 'edr_sec_plan.exe'],
    '启明星辰天珣EDRAgent': ['ESAV.exe', 'ESCCControl.exe', 'ESCC.exe', 'ESCCIndex.exe'],
    '蓝鲸Agent': ['gse_win_agent.exe', 'gse_win_daemon.exe'],
    '联想电脑管家': ['LAVService.exe'],
    'Sophos MCS Agent': ['McsAgent.exe'],
    'Sophos MCS Client': ['McsClient.exe'],
    '360TotalSecurity(360国际版)': ['QHSafeMain.exe', 'QHSafeTray.exe', 'QHWatchdog.exe', 'QHActiveDefense.exe'],
    'Sophos Device Control Service': ['sdcservice.exe'],
    'Sophos Endpoint Defense Service': ['SEDService.exe'],
    'Windows Defender SmartScreen': ['smartscreen.exe'],
    'Sophos Clean Service': ['SophosCleanM64.exe'],
    'Sophos FIM': ['SophosFIMService.exe'],
    'Sophos System Protection Service': ['SSPService.exe'],
    'Sophos Web Control Service': ['swc_service.exe'],
    '天眼云镜': ['TitanAgent.exe', 'TitanMonitor.exe'],
    '天融信终端防御': ['TopsecMain.exe', 'TopsecTray.exe'],
    '360杀毒-网盾': ['wdswfsafe.exe'],
    '智量安全': ['WiseVector.exe', 'WiseVectorSvc.exe'],
    '天擎': ['QAXEntClient.exe', 'QAXTray.exe'],
    '安恒主机卫士': ['AgentService.exe', 'ProtectMain.exe'],
    '亚信DS服务端': ['Deep Security Manager.exe'],
    '亚信DS客户端': ['dsa.exe', 'UniAccessAgent.exe', 'dsvp.exe'],
    '深信服EDR': ['/sangfor/edr/agent'],
    '阿里云云助手守护进程': ['/assist-daemon/assist_daemon'],
    'zabbix agen端': ['zabbix_agentd'],
    '阿里云盾升级': ['/usr/local/aegis/aegis_update/AliYunDunUpdate'],
    '阿里云助手': ['/usr/local/share/aliyun-assist'],
    '阿里系监控': ['AliHips', 'AliNet', 'AliDetect', 'AliScriptEngine'],
    '腾讯系监控': ['secu-tcs-agent', '/usr/local/qcloud/stargate/', '/usr/local/qcloud/monitor/', '/usr/local/qcloud/YunJing/'],
    '腾讯自动化助手TAT产品': ['/usr/local/qcloud/tat_agent/'],
    'SentinelOne(哨兵一号)': ['SentinelServiceHost.exe', 'SentinelStaticEngine.exe', 'SentinelStaticEngineScanner.exe', 'SentinelMemoryScanner.exe', 'SentinelAgent.exe', 'SentinelAgentWorker.exe', 'SentinelUI.exe'],
    'OneSec(微步)': ['tbAgent.exe', 'tbAgentSrv.exe', 'tbGuard.exe'],
    '亚信安全防毒墙网络版': ['PccNT.exe', 'PccNTMon.exe', 'PccNTUpd.exe'],
    'Illumio ZTS': ['venVtapServer.exe', 'venPlatformHandler.exe', 'venAgentMonitor.exe', 'venAgentMgr.exe'],
    '奇安信统一服务器安全': ['NuboshEndpoint.exe'],
    'IObit Malware Fighter': ['IMF.exe', 'IMFCore.exe', 'IMFsrv.exe', 'IMFSrvWsc.exe'],
    'Deep Instinct': ['DeepUI.exe']
            // 可以继续添加更多特征
        };

        function analyzeOutput() {
            const input = document.querySelector('.search-input').value;
            const loading = document.getElementById('loading');
            const results = document.getElementById('results');
            const countElement = document.getElementById('count');
            
            // 如果输入为空，显示提示
            if (!input.trim()) {
                results.innerHTML = `
                    <div class="empty-result">
                        <i class="fas fa-exclamation-circle"></i>
                        <p>请输入 tasklist /svc 命令的输出结果</p>
                    </div>
                `;
                return;
            }
            
            // 显示加载动画
            loading.style.display = 'block';
            results.innerHTML = '';
            
            // 模拟异步分析过程
            setTimeout(() => {
                const foundAV = {};
                const lines = input.toLowerCase().split('\n');
                
                // 分析每一行
                for (const line of lines) {
                    for (const [avName, signatures] of Object.entries(avSignatures)) {
                        if (signatures.some(sig => line.includes(sig.toLowerCase()))) {
                            if (!foundAV[avName]) {
                                foundAV[avName] = [];
                            }
                            
                            // 避免重复添加相同的进程
                            if (!foundAV[avName].includes(line.trim())) {
                                foundAV[avName].push(line.trim());
                            }
                        }
                    }
                }

                // 更新结果显示
                const avCount = Object.keys(foundAV).length;
                countElement.textContent = avCount;

                if (avCount === 0) {
                    results.innerHTML = `
                        <div class="empty-result">
                            <i class="fas fa-check-circle"></i>
                            <p>未检测到已知的安全软件</p>
                        </div>
                    `;
                } else {
                    // 按字母顺序排序结果
                    const sortedAV = Object.keys(foundAV).sort().reduce((obj, key) => {
                        obj[key] = foundAV[key];
                        return obj;
                    }, {});
                    
                    for (const [avName, processes] of Object.entries(sortedAV)) {
                        const card = document.createElement('div');
                        card.className = 'av-card';
                        
                        const html = `
                            <div class="av-name">${avName}</div>
                            <ul class="process-list">
                                ${processes.map(p => `<li class="process-item"><i class="fas fa-angle-right"></i> ${p}</li>`).join('')}
                            </ul>
                        `;
                        
                        card.innerHTML = html;
                        results.appendChild(card);
                    }
                }

                // 隐藏加载动画
                loading.style.display = 'none';
            }, 1500);
        }
    </script>
</body>
</html>
